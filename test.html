<html>
  <body>
    <div>
      <h3>Websocket client test</h3>
      <hr />

      <div>
        <b>Events Logs:</b>
        <ul id="body"></ul>
      </div>
    </div>
    <hr />

    <script src="https://cdn.socket.io/4.5.1/socket.io.min.js"></script>
    <script>
      const socket = io('http://localhost:7000/', {
        transports: ['websocket'], // Ensure the WebSocket transport is enabled
      });

      socket.on('connect', () => {
        let msg = 'Connected to WebSocket server';
        console.log(msg);
        const body = document.getElementById('body');
        const newMessageInBody = document.createElement('li');
        newMessageInBody.textContent = msg;
        body.appendChild(newMessageInBody);
      });

      socket.on('message', (data) => {
        let msg = `Got new messge from server`;
        console.log(msg);
        const body = document.getElementById('body');
        const newMessageInBody = document.createElement('li');
        newMessageInBody.textContent = msg;
        body.appendChild(newMessageInBody);
      });

      socket.on('broadcast', (data) => {
        let msg = `Message from ${data.from}: ${data.message}`;
        console.log(msg);
        const body = document.getElementById('body');
        const newMessageInBody = document.createElement('li');
        newMessageInBody.textContent = msg;
        body.appendChild(newMessageInBody);
      });

      socket.on('connect_error', (err) => {
        console.error('Connection error:', err);
      });

      // Send a message to the server
      socket.emit('message', 'Hello from client!');
    </script>
  </body>
</html>
